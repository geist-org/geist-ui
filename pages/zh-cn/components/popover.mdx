import { Layout, Playground, Attributes } from 'lib/components'
import { Popover, Spacer, Link, Row, Col, useTheme } from 'components'
import { useState } from 'react'
import { addColorAlpha } from 'components/utils/color'

export const meta = {
  title: '气泡卡片 Popover',
  group: '数据展示',
}

## Popover / 气泡卡片

通过点击或鼠标移入触发的气泡风格弹出层。

<Playground
  desc="基础示例。"
  scope={{ Popover, Spacer, Link, useState, useTheme, addColorAlpha }}
  code={`
() => {
  const theme = useTheme()
  const content = () => (
    <div style={{ padding: '16px' }}>
      <Link href="#">A hyperlink</Link>
      <Spacer y={0.5} />
      <Link href="#">External link</Link>
    </div>
  )
  const Option = () => {
    const [hover, setHover] = useState(false)
    return (
      <p
        onMouseOver={() => setHover(true)}
        onMouseOut={() => setHover(false)}
        style={{
          margin: 0,
          padding: theme.layout.gap,
          color: hover ? theme.palette.cTheme5 : theme.palette.cNeutral5,
          backgroundColor: hover ? addColorAlpha(theme.palette.cTheme5, 0.04) : 'transparent',
        }}>
        菜单内容
      </p>
    )
  }
  const contentWithBackgroundColor = () => (
    <div>
      <Option />
      <Option />
      <Option />
    </div>
  )
  return (
    <>
      <Popover title="菜单标题" content={content}>
        菜单
      </Popover>
      <Spacer inline />
      <Popover title="菜单标题" content={contentWithBackgroundColor}>
        带背景色
      </Popover>
    </>
  )
}
`}
/>

<Playground
  title="预置子选项"
  desc="使用预置的 `Item` 组件完成弹出内容的布局。"
  scope={{ Popover, Spacer, Link }}
  code={`
() => {
  const content = () => (
    <>
      <Popover.Item>
        <Link href="#">A hyperlink</Link>
      </Popover.Item>
      <Popover.Item line />
      <Popover.Item>
        <Link href="#">A hyperlink for edit profile</Link>
      </Popover.Item>
      <Popover.Item line />
      <Popover.Item>
        <span>Command-Line</span>
      </Popover.Item>
    </>
  )
  const contentLong = () => (
    <>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
      <Popover.Item>
        菜单内容
      </Popover.Item>
    </>
  )
  return (
    <>
      <Popover title='菜单标题' content={content}>
        菜单
      </Popover>
      <Spacer inline />
      <Popover title='菜单标题' notSeperateTitle content={content}>
        标题不带分割线
      </Popover>
      <Spacer inline />
      <Popover title='菜单标题' content={contentLong}>
        带滚动条
      </Popover>
    </>
  )
}
`}
/>

<Playground
  title="对齐方式"
  desc="有 12 种对齐方式可用。"
  scope={{ Popover, Link, Spacer, Row, Col }}
  code={`
() => {
  const content = () => (
    <>
      <Popover.Item>
        菜单内容
      </Popover.Item>
    </>
  )
  const Center = ({ children, ...props }) => (
    <Col style={{ display: 'flex', justifyContent: 'center' }} {...props}>{children}</Col>
  )
  return (
    <div style={{ width: '80%', margin: '0 auto' }}>
      <Row justify="center">
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="topStart">topStart</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="top">top</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="topEnd">topEnd</Popover>
        </Center>
      </Row>
      <Row justify="space-between">
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="leftStart">leftStart</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="rightStart">rightStart</Popover>
        </Center>
      </Row>
      <Spacer y={.5} />
      <Row justify="space-between">
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="left">left</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="right">right</Popover>
        </Center>
      </Row>
      <Spacer y={.5} />
      <Row justify="space-between">
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="leftEnd">leftEnd</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="rightEnd">rightEnd</Popover>
        </Center>
      </Row>
      <Row justify="center">
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="bottomStart">bottomStart</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="bottom">bottom</Popover>
        </Center>
        <Center span={5}>
          <Popover notSeperateTitle title='菜单标题' content={content} placement="bottomEnd">bottomEnd</Popover>
        </Center>
      </Row>
    </div>
  )
}
`}
/>

<Playground
  title="手动关闭"
  desc="你可以控制何时手动地关闭弹出卡片。"
  scope={{ Popover, Spacer, Link, useState }}
  code={`
() => {
  const [visible, setVisible] = useState(false)
  const changeHandler = (next) => {
    setVisible(next)
  }
  const content = () => (
    <div style={{ padding: '16px' }}>
      <span onClick={() => setVisible(false)}>点击关闭</span>
      <Spacer y={.5} />
      <span>不关闭</span>
    </div>
  )
  return (
    <Popover content={content} visible={visible}
      onVisibleChange={changeHandler}>
      菜单
    </Popover>
  )
}
`}
/>

<Attributes edit="/pages/zh-cn/components/popover.mdx">
<Attributes.Title>Popover.Props</Attributes.Title>

| 属性                 | 描述                         | 类型                          | 推荐值                           | 默认     |
| -------------------- | ---------------------------- | ----------------------------- | -------------------------------- | -------- |
| **title**            | 气泡卡片标题                 | `ReactNode` `() => ReactNode` | -                                | -        |
| **notSeperateTitle** | 标题与内容间不增加增加分割线 | `boolean`                     | -                                | false    |
| **content**          | 气泡卡片内容                 | `ReactNode` `() => ReactNode` | -                                | -        |
| **visible**          | 手动控制气泡的显示与隐藏     | `boolean`                     | -                                | `false`  |
| **defaultVisible**   | 初始是否可见                 | `boolean`                     | -                                | `false`  |
| **hideArrow**        | 隐藏箭头                     | `boolean`                     | -                                | `false`  |
| **placement**        | 气泡卡片与目标的对齐方式     | [Placement](#placement)       | -                                | `bottom` |
| **trigger**          | 触发气泡卡片的方式           | `'click' / 'hover'`           | -                                | `click`  |
| **enterDelay**(ms)   | 在提示显示前的延迟           | `number`                      | -                                | `100`    |
| **leaveDelay**(ms)   | 关闭提示前的延迟             | `number`                      | -                                | `0`      |
| **offset**(px)       | 提示框与目标之间的偏移       | `number`                      | -                                | `12`     |
| **portalClassName**  | 气泡卡片的类名               | `string`                      | -                                | -        |
| **onVisibleChange**  | 当气泡卡片状态改变时触发     | `(visible: boolean) => void`  | -                                | -        |
| ...                  | 原生属性                     | `HTMLAttributes`              | `'id', 'name', 'className', ...` | -        |

<Attributes.Title alias="Popover.Option">Popover.Item</Attributes.Title>

| 属性     | 描述     | 类型      | 推荐值 | 默认    |
| -------- | -------- | --------- | ------ | ------- |
| **line** | 显示线条 | `boolean` | -      | `false` |

<Attributes.Title>Placement</Attributes.Title>

```ts
type Placement = 'top'
  | 'topStart',
  | 'topEnd',
  | 'left',
  | 'leftStart',
  | 'leftEnd',
  | 'bottom',
  | 'bottomStart',
  | 'bottomEnd',
  | 'right',
  | 'rightStart',
  | 'rightEnd',
```

</Attributes>

export default ({ children }) => <Layout meta={meta}>{children}</Layout>
